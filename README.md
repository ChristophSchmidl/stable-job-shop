# Stable baselines applied to custom OpenAI job-shop environment

Reinforcement Learning applied to permutation job shop problems.


## Getting started

This repository has been implemented in Python version 3.9.13.



## Instructions

- [ ] Add argparse in ``src/main.py`` to interact with the implementation over the command line.
- [ ] Show excerpt of ``python src/main.py --help`` with available command line arguments.
- [ ] List commands for most common use cases.     

### Requirements

- Stable-baselines3: https://github.com/DLR-RM/stable-baselines3
- OpenAI gym: 
- OpenAI gym box2d:
- Swig (requirement to install box2d?)
- An OpenAi Gym environment for the Job Shop Scheduling problem: https://github.com/prosysscience/JSSEnv 



## Experiments

### Experiment 1

- [ ] Train an RL agent using PPO on Taillard instance 41 (30 jobs, 20 machines). **Note**: Tassel et al (A Reinforcement Learning Environment For Job-Shop Scheduling) used this instance to perform their hyperparamter optimization and then trained Taillard instances ta41 - ta50 with these hyperparameters. They did not cross-validate their trained policies, e.g., apply policy $\pi_{ta_{41}}$ to instance [ta42-50]
- [ ] (optional) Reproduce the result by Tassel et al on ta41. This is not really necessary but would be nice to have :)
- [ ] Apply trained policy $\pi_{ta_{41}}$ to Taillard instances ta42-ta50 and track the makespan.
- [ ] Given that we do not have informative baselines for ta41-ta50, we could apply FIFO and MWKR dispatching rules or/and state-of-the-art upper and lower bounds. Furthermore, it would be beneficial to also train separate policies for ta42-ta50 and compare the makespans to those which were generated by policy $\pi_{ta_{41}}$. We assume that a dedicated policy trained on a specific instance has a lower makespan than a "foreign" policy trained on another instance.
- [ ] Permutation comes into play.

### Experiment 2

- [ ] Test

## Action masking

- Maskable PPO: https://sb3-contrib.readthedocs.io/en/master/modules/ppo_mask.html
- Paper "A Closer Look at Invalid Action Masking in Policy Gradient Algorithms": https://arxiv.org/abs/2006.14171
- Blog post: https://costa.sh/blog-a-closer-look-at-invalid-action-masking-in-policy-gradient-algorithms.html
- Another blog post: https://boring-guy.sh/posts/masking-rl/